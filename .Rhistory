ans <- hist(ests[,10],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,11], freq=FALSE, col="green", xlab="Q22", main = "Distribution of Q22",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,11]), sd=sd(ests[,11])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[10], col="red", lwd=3)
text(true_par[10], y = ymax, labels = paste("True Q22:",true_par[10]),pos=4, cex=2)
dev.off()
png("~/Projects/spm_test/tb_results_2D_N500_numsim100.png",height=1080, width=1920)
par(mfrow=c(3,5))
# a11:
ans <- hist(ests[,1],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,1], freq=FALSE, col="green", xlab="a11", main = "Distribution of a11",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,1]), sd=sd(ests[,1])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[1], col="red", lwd=3)
text(true_par[1], y = ymax, labels = paste("True a11:",true_par[1]),pos=4, cex=2)
# a21:
ans <- hist(ests[,2],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,2], freq=FALSE, col="green", xlab="a21", main = "Distribution of a21",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,2]), sd=sd(ests[,2])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[2], col="red", lwd=3)
text(true_par[2], y = ymax, labels = paste("True a21:",true_par[2]),pos=4, cex=2)
# a12:
ans <- hist(ests[,3],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,3], freq=FALSE, col="green", xlab="a12", main = "Distribution of a12",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,3]), sd=sd(ests[,3])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[3], col="red", lwd=3)
text(true_par[3], y = ymax, labels = paste("True a12:",true_par[3]),pos=4, cex=2)
# a22:
ans <- hist(ests[,4],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,4], freq=FALSE, col="green", xlab="a22", main = "Distribution of a22",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,4]), sd=sd(ests[,4])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[4], col="red", lwd=3)
text(true_par[4], y = ymax, labels = paste("True a22:",true_par[4]),pos=4, cex=2)
# f1_1:
ans <- hist(ests[,5],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,5], freq=FALSE, col="green", xlab="f1_1", main = "Distribution of f1_1",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,6]), sd=sd(ests[,5])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[5], col="red", lwd=3)
text(true_par[5], y = ymax, labels = paste("True f1_1:",true_par[5]),pos=4, cex=2)
# f1_2:
ans <- hist(ests[,6],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,6], freq=FALSE, col="green", xlab="f1_2", main = "Distribution of f1_2",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,6]), sd=sd(ests[,6])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[6], col="red", lwd=3)
text(true_par[6], y = ymax, labels = paste("True f1_2:",true_par[6]),pos=4, cex=2)
# Q11:
ans <- hist(ests[,7],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,7], freq=FALSE, col="green", xlab="Q11", main = "Distribution of Q11",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,7]), sd=sd(ests[,7])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[7], col="red", lwd=3)
text(true_par[7], y = ymax, labels = paste("True Q11:",true_par[7]),pos=4, cex=2)
# Q21:
ans <- hist(ests[,8],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,8], freq=FALSE, col="green", xlab="Q21", main = "Distribution of Q21",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,8]), sd=sd(ests[,8])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[8], col="red", lwd=3)
text(true_par[8], y = ymax, labels = paste("True Q21:",true_par[8]),pos=4, cex=2)
# Q12:
ans <- hist(ests[,9],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,9], freq=FALSE, col="green", xlab="Q12", main = "Distribution of Q12",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,9]), sd=sd(ests[,9])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[9], col="red", lwd=3)
text(true_par[9], y = ymax, labels = paste("True Q12:",true_par[9]),pos=4, cex=2)
# Q22:
ans <- hist(ests[,10],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,10], freq=FALSE, col="green", xlab="Q22", main = "Distribution of Q22",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,10]), sd=sd(ests[,10])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[10], col="red", lwd=3)
text(true_par[10], y = ymax, labels = paste("True Q22:",true_par[10]),pos=4, cex=2)
# f_1:
ans <- hist(ests[,11],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,11], freq=FALSE, col="green", xlab="f_1", main = "Distribution of f_1",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,11]), sd=sd(ests[,11])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[11], col="red", lwd=3)
text(true_par[11], y = ymax, labels = paste("True f_1:",true_par[11]),pos=4, cex=2)
# f_2:
ans <- hist(ests[,12],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,12], freq=FALSE, col="green", xlab="f_2", main = "Distribution of f_2",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,12]), sd=sd(ests[,12])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[12], col="red", lwd=3)
text(true_par[12], y = ymax, labels = paste("True f_2:",true_par[12]),pos=4, cex=2)
# b_1:
ans <- hist(ests[,13],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,13], freq=FALSE, col="green", xlab="b_1", main = "Distribution of b_1",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,13]), sd=sd(ests[,13])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[13], col="red", lwd=3)
text(true_par[13], y = ymax, labels = paste("True b_1:",true_par[13]),pos=4, cex=2)
# b_2:
ans <- hist(ests[,14],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,14], freq=FALSE, col="green", xlab="b_2", main = "Distribution of b_2",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,14]), sd=sd(ests[,14])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[14], col="red", lwd=3)
text(true_par[14], y = ymax, labels = paste("True b_2:",true_par[14]),pos=4, cex=2)
# mu0:
ans <- hist(ests[,15],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,15], freq=FALSE, col="green", xlab="mu0", main = "Distribution of mu0",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,15]), sd=sd(ests[,15])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[15], col="red", lwd=3)
text(true_par[15], y = ymax, labels = paste("True mu0:",true_par[15]),pos=4, cex=2)
# theta:
ans <- hist(ests[,16],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,16], freq=FALSE, col="green", xlab="theta", main = "Distribution of theta",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,16]), sd=sd(ests[,16])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[16], col="red", lwd=3)
text(true_par[16], y = ymax, labels = paste("True theta:",true_par[16]),pos=4, cex=2)
dev.off()
png("~/Projects/spm_test/tb_results_2D_N500_numsim100.png",height=1080, width=1920)
par(mfrow=c(3,5))
# a11:
ans <- hist(ests[,1],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,1], freq=FALSE, col="green", xlab="a11", main = "Distribution of a11",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,1]), sd=sd(ests[,1])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[1], col="red", lwd=3)
text(true_par[1], y = ymax, labels = paste("True a11:",true_par[1]),pos=4, cex=2)
# a21:
ans <- hist(ests[,2],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,2], freq=FALSE, col="green", xlab="a21", main = "Distribution of a21",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,2]), sd=sd(ests[,2])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[2], col="red", lwd=3)
text(true_par[2], y = ymax, labels = paste("True a21:",true_par[2]),pos=4, cex=2)
# a12:
ans <- hist(ests[,3],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,3], freq=FALSE, col="green", xlab="a12", main = "Distribution of a12",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,3]), sd=sd(ests[,3])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[3], col="red", lwd=3)
text(true_par[3], y = ymax, labels = paste("True a12:",true_par[3]),pos=4, cex=2)
# a22:
ans <- hist(ests[,4],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,4], freq=FALSE, col="green", xlab="a22", main = "Distribution of a22",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,4]), sd=sd(ests[,4])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[4], col="red", lwd=3)
text(true_par[4], y = ymax, labels = paste("True a22:",true_par[4]),pos=4, cex=2)
# f1_1:
ans <- hist(ests[,5],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,5], freq=FALSE, col="green", xlab="f1_1", main = "Distribution of f1_1",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,6]), sd=sd(ests[,5])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[5], col="red", lwd=3)
text(true_par[5], y = ymax, labels = paste("True f1_1:",true_par[5]),pos=4, cex=2)
# f1_2:
ans <- hist(ests[,6],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,6], freq=FALSE, col="green", xlab="f1_2", main = "Distribution of f1_2",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,6]), sd=sd(ests[,6])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[6], col="red", lwd=3)
text(true_par[6], y = ymax, labels = paste("True f1_2:",true_par[6]),pos=4, cex=2)
# Q11:
ans <- hist(ests[,7],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,7], freq=FALSE, col="green", xlab="Q11", main = "Distribution of Q11",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,7]), sd=sd(ests[,7])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[7], col="red", lwd=3)
text(true_par[7], y = ymax, labels = paste("True Q11:",true_par[7]),pos=4, cex=2)
# Q21:
ans <- hist(ests[,8],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,8], freq=FALSE, col="green", xlab="Q21", main = "Distribution of Q21",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,8]), sd=sd(ests[,8])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[8], col="red", lwd=3)
text(true_par[8], y = ymax, labels = paste("True Q21:",true_par[8]),pos=4, cex=2)
# Q12:
ans <- hist(ests[,9],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,9], freq=FALSE, col="green", xlab="Q12", main = "Distribution of Q12",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,9]), sd=sd(ests[,9])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[9], col="red", lwd=3)
text(true_par[9], y = ymax, labels = paste("True Q12:",true_par[9]),pos=4, cex=2)
# Q22:
ans <- hist(ests[,10],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,10], freq=FALSE, col="green", xlab="Q22", main = "Distribution of Q22",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,10]), sd=sd(ests[,10])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[10], col="red", lwd=3)
text(true_par[10], y = ymax, labels = paste("True Q22:",true_par[10]),pos=4, cex=2)
# f_1:
ans <- hist(ests[,11],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,11], freq=FALSE, col="green", xlab="f_1", main = "Distribution of f_1",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,11]), sd=sd(ests[,11])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[11], col="red", lwd=3)
text(true_par[11], y = ymax, labels = paste("True f_1:",true_par[11]),pos=4, cex=2)
# f_2:
ans <- hist(ests[,12],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,12], freq=FALSE, col="green", xlab="f_2", main = "Distribution of f_2",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,12]), sd=sd(ests[,12])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[12], col="red", lwd=3)
text(true_par[12], y = ymax, labels = paste("True f_2:",true_par[12]),pos=4, cex=2)
# b_1:
ans <- hist(ests[,13],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,13], freq=FALSE, col="green", xlab="b_1", main = "Distribution of b_1",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,13]), sd=sd(ests[,13])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[13], col="red", lwd=3)
text(true_par[13], y = ymax, labels = paste("True b_1:",true_par[13]),pos=4, cex=2)
# b_2:
ans <- hist(ests[,14],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,14], freq=FALSE, col="green", xlab="b_2", main = "Distribution of b_2",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,14]), sd=sd(ests[,14])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[14], col="red", lwd=3)
text(true_par[14], y = ymax, labels = paste("True b_2:",true_par[14]),pos=4, cex=2)
# mu0:
ans <- hist(ests[,15],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,15], freq=FALSE, col="green", xlab="mu0", main = "Distribution of mu0",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,15]), sd=sd(ests[,15])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[15], col="red", lwd=3)
text(true_par[15], y = ymax, labels = paste("True mu0:",true_par[15]),pos=4, cex=2)
# theta:
ans <- hist(ests[,16],plot=F)
ymax <- max(ans$density) + 1/10*max(ans$density)
hist(ests[,16], freq=FALSE, col="green", xlab="theta", main = "Distribution of theta",ylim=c(0, ymax))
curve(dnorm(x, mean=mean(ests[,16]), sd=sd(ests[,16])), add=TRUE, col="darkblue", lwd=2)
abline(v = true_par[16], col="red", lwd=3)
text(true_par[16], y = ymax, labels = paste("True theta:",true_par[16]),pos=4, cex=2)
dev.off()
longdat <- read.csv(system.file("data","longdat.csv",package="spm"))
vitstat <- read.csv(system.file("data","vitstat.csv",package="spm"))
head(longdat)
library(spm)
?sim
simdata
?simdata
ans=simdata()
head(ans)
sim_discrete()
ans-sim_discrete()
ans=sim_discrete()
head(ans)
ans=sim_discrete()
ans=sim_discrete(N=10000)
head(ans)
longdat.sim_1D = sim_discrete(N=10000)[,1:5]
head(longdat.sim_1D)
head(longdat)
longdat.sim_1D = sim_discrete(N=10000,dt = 2)[,1:5]
head(longdat.sim_1D)
library(spm)
longdat <- read.csv(system.file("data","longdat.csv",package="spm"))
vitstat <- read.csv(system.file("data","vitstat.csv",package="spm"))
longdat.sim_1D = sim_discrete(N=10000,dt = 2)[,1:5]
head(longdat.sim_1D)
head(longdat)
colnames(longdat.sim_1D) <- c("ID", "IsDead", "Age", "AgeNext", "DBP")
head(longdat.sim_1D)
head(vitstat)
ids=unique(longdat.sim_1D[,1])
head(ids)
longdat.sim_1D_splitted <- split(longdat.sim_1D, "ID")
length(splitted)
length(longdat.sim_1D_splitted)
longdat.sim_1D_splitted
longdat.sim_1D_splitted[[1]]
longdat.sim_1D
head(longdat.sim_1D)
longdat.sim_1D_splitted <- split(longdat.sim_1D, longdat.sim_1D[["ID"]])
longdat.sim_1D_splitted <- split(longdat.sim_1D, longdat.sim_1D[["ID"]])
head(longdat.sim_1D)
longdat.sim_1D[["ID"]]
longdat.sim_1D["ID"]
longdat.sim_1D_splitted <- split(longdat.sim_1D, longdat.sim_1D[["ID"]])
longdat.sim_1D[["ID"]]
longdat.sim_1D_splitted <- split(longdat.sim_1D, as.data.frame(longdat.sim_1D)[["ID"]])
longdat.sim_1D_splitted
as.data.frame(longdat.sim_1D)
longdat.sim_1D_splitted <- split(as.data.frame(longdat.sim_1D), as.data.frame(longdat.sim_1D)[["ID"]])
longdat.sim_1D_splitted[[1]]
length(longdat.sim_1D_splitted)
ans=unlist(lapply(1:length(longdat.sim_1D_splitted), function(n) {longdat.sim_1D_splitted[[n]][dim(longdat.sim_1D_splitted[[n]]),]} ))
head(ans)
ans
ans[1:100,]
longdat.sim_1D_splitted[[1]][dim(longdat.sim_1D_splitted[[1]]),]
longdat.sim_1D_splitted[[1]]
ans=unlist(lapply(1:length(longdat.sim_1D_splitted), function(n) {longdat.sim_1D_splitted[[n]][dim(longdat.sim_1D_splitted[[n]])[1],]} ))
head(ans)
ans
dim(ans)
length(ans)
vitstat <- matrix()
lapply(1:length(longdat.sim_1D_splitted), function(n) {vitstat=rbind(vitstat,longdat.sim_1D_splitted[[n]][dim(longdat.sim_1D_splitted[[n]])[1],])} )
vitstat.sim_1D <- matrix(nrow=0, ncol=dim(longdat.sim_1D)[2])
for(i in 1:length(longdat.sim_1D_splitted)) {
vitstat.sim_1D <- rbind(vitstat.sim_1D, longdat.sim_1D_splitted[[i]][dim(longdat.sim_1D_splitted[[i]])[1],])
}
head(vitstat.sim_1D)
head(vitstat)
vitstat <- read.csv(system.file("data","vitstat.csv",package="spm"))
head(vitstat)
head(longdat)
longdat[1:20,]
vitstat.sim_1D
library(spm)
longdat <- read.csv(system.file("data","longdat.csv",package="spm"))
vitstat <- read.csv(system.file("data","vitstat.csv",package="spm"))
longdat.sim_1D = sim_discrete(N=10000,dt = 2)[,1:5]
colnames(longdat.sim_1D) <- c("ID", "IndicatorDeath", "Age", "AgeNext", "DBP")
head(longdat.sim_1D)
longdat.sim_1D_splitted <- split(as.data.frame(longdat.sim_1D), as.data.frame(longdat.sim_1D)[["ID"]])
vitstat.sim_1D <- matrix(nrow=0, ncol=dim(longdat.sim_1D)[2])
for(i in 1:length(longdat.sim_1D_splitted)) {
vitstat.sim_1D <- rbind(vitstat.sim_1D, longdat.sim_1D_splitted[[i]][dim(longdat.sim_1D_splitted[[i]])[1],])
}
vitstat.sim_1D
head(vitstat.sim_1D)
vitstat.sim_1D <- cbind(vitstat.sim_1D[,1], vitstat.sim_1D[,2], vitstat.sim_1D[,4])
colnames(vitstat.sim_1D) <- c("ID", "IsDead", "LSmort")
vitstat.sim_1D
head(vitstat.sim_1D)
data=prepare_data(longdat=longdat.sim_1D, vitstat=vitstat.sim_1D,interval=1, col.status="IsDead", col.id="ID", col.age="Age", col.age.event="LSmort", covariates=c("DBP"), verbose=T)
data=prepare_data(longdat=as.data.frame(longdat.sim_1D), vitstat=as.data.frame(vitstat.sim_1D),interval=1, col.status="IsDead", col.id="ID", col.age="Age", col.age.event="LSmort", covariates=c("DBP"), verbose=T)
head(data[[1]])
head(data[[2]])
library(spm)
longdat <- read.csv(system.file("data","longdat.csv",package="spm"))
vitstat <- read.csv(system.file("data","vitstat.csv",package="spm"))
data=prepare_data(longdat=longdat.nonan, vitstat=vitstat.nonan,interval=1, col.status="IsDead", col.id="ID", col.age="Age", col.age.event="LSmort", verbose=T)
longdat.nonan <- longdat[which(is.na(longdat$Age) == F),]
vitstat.nonan <- vitstat[which(is.na(vitstat$BirthCohort) == F),]
data=prepare_data(longdat=longdat.nonan, vitstat=vitstat.nonan,interval=1, col.status="IsDead", col.id="ID", col.age="Age", col.age.event="LSmort", verbose=T)
head(data[[1]])
head(data[[2]])
?spm
pars <- spm(data[[1]])
pars <- spm(data[[2]])
pars <- spm(data[[1]][,2:dim(data[[1]][2])])
pars <- spm(data[[1]][,2:dim(data[[1]][2])],k=6)
data[[1]][,2:dim(data[[1]][2])]
pars <- spm(data[[1]][,2:dim(data[[1]])[2]],k=6)
data[[1]][,2:dim(data[[1]])[2]]
pars <- spm(data[[1]][,2:dim(data[[1]])[2]],k=5)
pars <- spm(data[[1]][,2:dim(data[[1]])[2]],k=6)
pars <- spm(data[[1]][,2:dim(data[[1]])[2]],k=7)
pars <- spm(data[[1]],k=7)
head(data[[1]])
pars <- spm(data[[1]][,2:dim(data[[1]])[2]],k=6)
pars <- spm(data[[1]],k=6)
pars <- spm(data[[2]],k=6)
spm
pars <- spm(data,k=6)
pars <- spm(data,k=6, verbose=T)
head(data[[1]])
longdat.sim = sim_discrete(N=10000,dt = 2,a = pars$pars2$a, pars$pars2$f1, pars$pars2$Q, pars$pars2$f, pars$pars2$b, pars$pars2$mu0, pars$pars2$theta, k = 6, ystart=c(80, 25, 80, 90, 70, 175))[,1:5]
pars
library(spm)
longdat <- read.csv(system.file("data","longdat.csv",package="spm"))
vitstat <- read.csv(system.file("data","vitstat.csv",package="spm"))
longdat.nonan <- longdat[which(is.na(longdat$Age) == F),]
vitstat.nonan <- vitstat[which(is.na(vitstat$BirthCohort) == F),]
data=prepare_data(longdat=longdat.nonan, vitstat=vitstat.nonan,interval=1, col.status="IsDead", col.id="ID", col.age="Age", col.age.event="LSmort", verbose=T)
pars <- spm(data,k=6, verbose=T)
pars
longdat.sim = sim_discrete(N=10000,dt = 2,a = pars$starting$a, pars$starting$f1, pars$starting$Q, pars$starting$f, pars$starting$b, pars$starting$mu0, pars$starting$theta, k = 6, ystart=c(80, 25, 80, 90, 70, 175))[,1:5]
colnames(longdat.sim) <- c("ID", "IndicatorDeath", "Age", "AgeNext", "DBP")
head(longdat.sim)
longdat.sim = sim_discrete(N=10000,dt = 2,a = pars$starting$a, pars$starting$f1, pars$starting$Q, pars$starting$f, pars$starting$b, pars$starting$mu0, pars$starting$theta, k = 6, ystart=c(80, 25, 80, 90, 70, 175))
head(longdat.sim)
data=prepare_data(longdat=longdat.nonan, vitstat=vitstat.nonan,interval=1, col.status="IsDead", col.id="ID", col.age="Age", col.age.event="LSmort", verbose=T,covariates = c("DBP", "BMI"))
pars <- spm(data,k=2, verbose=T)
pars
longdat.sim = sim_discrete(N=10000,dt = 2,a = pars$starting$a, pars$starting$f1, pars$starting$Q, pars$starting$f, pars$starting$b, pars$starting$mu0, pars$starting$theta, k = 6, ystart=c(80, 25, 80, 90, 70, 175))
pars
pars$starting$a
longdat.sim = sim_discrete(N=10000,dt = 2,a = pars$starting$a, pars$starting$f1, pars$starting$Q, pars$starting$f, pars$starting$b, pars$starting$mu0, pars$starting$theta, k = 2, ystart=c(80, 25))
colnames(longdat.sim) <- c("ID", "IndicatorDeath", "Age", "AgeNext", "DBP")
head(longdat.sim)
data
head(longdat.sim)
longdat.sim <- cbind(longdat.sim[,1:4], longdat.sim[,5], longdat.sim[,7])
colnames(longdat.sim) <- c("ID", "IndicatorDeath", "Age", "AgeNext", "DBP", "BMI")
head(longdat.sim)
longdat.sim_splitted <- split(as.data.frame(longdat.sim), as.data.frame(longdat.sim)[["ID"]])
vitstat.sim <- matrix(nrow=0, ncol=dim(longdat.sim)[2])
for(i in 1:length(longdat.sim_splitted)) {
vitstat.sim <- rbind(vitstat.sim, longdat.sim_splitted[[i]][dim(longdat.sim_splitted[[i]])[1],])
}
head(vitstat.sim)
vitstat.sim <- cbind(vitstat.sim[,1], vitstat.sim[,2], vitstat.sim[,4])
colnames(vitstat.sim) <- c("ID", "IsDead", "LSmort")
vitstat.sim
vitstat.sim <- as.data.frame(vitstat.sim)
longdat.sim <- as.data.frame(longdat.sim)
head(longdat.sim)
data=prepare_data(longdat=longdat.sim, vitstat=vitstat.sim,interval=1, col.status="IsDead", col.id="ID", col.age="Age", col.age.event="LSmort", covariates=c("DBP"), verbose=T)
pars <- spm(data,k=2, verbose=T)
pars <- spm(data,k=1, verbose=T)
pars
write.csv("~/Projects/spm/inst/data/longdat.csv", longdat.sim)
?write.csv
write.csv(file="~/Projects/spm/inst/data/longdat.csv", x=longdat.sim)
write.csv(file="~/Projects/spm/inst/data/vitstat.csv", x=vitstat.sim)
longdat.sim <- sim_discrete(N=1000,dt = 2,a = pars$starting$a, pars$starting$f1, pars$starting$Q, pars$starting$f, pars$starting$b, pars$starting$mu0, pars$starting$theta, k = 2, ystart=c(80, 25))
longdat.sim <- cbind(longdat.sim[,1:4], longdat.sim[,5], longdat.sim[,7])
colnames(longdat.sim) <- c("ID", "IndicatorDeath", "Age", "AgeNext", "DBP", "BMI")
longdat.sim <- as.data.frame(longdat.sim)
head(longdat.sim)
longdat.sim_splitted <- split(as.data.frame(longdat.sim), as.data.frame(longdat.sim)[["ID"]])
vitstat.sim <- matrix(nrow=0, ncol=dim(longdat.sim)[2])
for(i in 1:length(longdat.sim_splitted)) {
vitstat.sim <- rbind(vitstat.sim, longdat.sim_splitted[[i]][dim(longdat.sim_splitted[[i]])[1],])
}
head(vitstat.sim)
vitstat.sim <- cbind(vitstat.sim[,1], vitstat.sim[,2], vitstat.sim[,4])
colnames(vitstat.sim) <- c("ID", "IsDead", "LSmort")
vitstat.sim <- as.data.frame(vitstat.sim)
write.csv(file="~/Projects/spm/inst/data/longdat.csv", x=longdat.sim)
write.csv(file="~/Projects/spm/inst/data/vitstat.csv", x=vitstat.sim)
shiny::runApp('Projects/ld_effects')
library(shinyapps)
shinyapps::setAccountInfo(name='ilmadester',token='1D5950B47F9FFD38E2ED2609985BAF8A',secret='fbL28KfBVVOGAG2NNR6kFpUW6gIcKlZZ04Fxpmnx')
shinyapps::deployApp("~/Projects/ld_effects/")
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
shiny::runApp('Projects/ld_effects')
library(shinyapps)
shinyapps::setAccountInfo(name='ilmadester',token='1D5950B47F9FFD38E2ED2609985BAF8A',secret='fbL28KfBVVOGAG2NNR6kFpUW6gIcKlZZ04Fxpmnx')
shinyapps::deployApp("~/Projects/ld_effects/")
browseVignettes("spm")
browseVignettes("dplyr")
browseVignettes("ggplot2")
browseVignettes("SKAT")
browseVignettes("seqMETA")
browseVignettes("seqMeta")
browseVignettes("survival")
?pf
library(SKAT)
SKAT
?pf
?pchisq
pnorm
?pnorm
library(SKAT)
skat
SKAT
?SKAT
?SKAT_Null_Model
?pchisq
library(SKAT)
?SKAT_Null_Model
install.packages("rmarkdown")
devtools::use_vignette("~/Projects/spm/man/spm-vignette")
setwd("~/Projects/spm")
devtools::use_vignette("spm-vignette")
---
title: "Vignette Title"
vignette(spm)
library(spm)
vignette(spm)
browseVignettes("spm")
library(SKAT)
browseVignettes("SKAT")
?spm
In two previous cases, we assumed that coefficients is sort of time-dependant: we multiplied them on to $$\exp{\theta t}$$. In general, this may not be the case. We extend this to a general case, i.e. (we consider one-dimensional case):
?simdataND
?simdataMD
library(spm)
spm
?sim
?simdat
?simdatMD
?simdataMD
?simdataND
?simdatND
?sim_discrete
?simdata_cont_MD
